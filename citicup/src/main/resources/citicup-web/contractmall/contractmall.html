<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Contract Mall</title>
    <link href="../lib/bootstrap-4.0.0-dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="../components/top-nav.css" rel="stylesheet"/>
    <link rel="stylesheet" href="layui/css/layui.css" media="all">
    <script src="../lib/jquery-3.3.1.js"></script>
    <script src="layui/layui.js"></script>
    <script src="../lib/bootstrap-4.0.0-dist/js/bootstrap.min.js"></script>
    <script src="../lib/echarts.min.js"></script>
    <script src="../util/href-helper.js"></script>
    <script src="mall.js"></script>
    <link rel="stylesheet" type="text/css" href="mall.css">
</head>

</head>
<body>
<div class="top-nav"></div>
<div class="content-wrapper" id="contentdiv">
    <div class="content" style="">

        <div class="ft_board">
            <button class="ft_button" id="all" onclick="ftclicked(this.id)" style="margin-left: 0px; color:#FD6857 ">全部期货 </button>
            <button class="ft_button" id="financial" onclick="ftclicked(this.id)" >金融期货</button>
            <button class="ft_button" id="agriculture"  onclick="ftclicked(this.id)"  style="width: 122px;">农产品期货</button>
            <button class="ft_button" id="metal" onclick="ftclicked(this.id)" >金属期货</button>
            <button class="ft_button" id="energy" onclick="ftclicked(this.id)" >能源期货</button>
            <button class="ft_button" id="chemical" onclick="ftclicked(this.id)" >化工期货</button>
        </div>

        <div class="ftb_board">
            <div class="ftb_bottom" id="all_bottom" style="margin-left: 0px; visibility: visible"></div>
            <div class="ftb_bottom" id="financial_bottom"></div>
            <div class="ftb_bottom" id="agriculture_bottom" style="width: 122px;"></div>
            <div class="ftb_bottom" id="metal_bottom"></div>
            <div class="ftb_bottom" id="energy_bottom"></div>
            <div class="ftb_bottom" id="chemical_bottom"></div>
        </div>

        <hr style="margin-top: 10px;margin-bottom: 15px;">

        <!-- 筛选条件 -->
        <div>
            <div class="sameline" style="margin-left: 0px;">
                <button class="layui-btn layui-btn-primary conditionbutton" id="gross"><p class="conditiontext">总收益率</p></button>
                <div class="tipboard" id="gross-tip">
                    <!-- 范围 -->
                    <div class="layui-form-item" style="width: 500px;">
                        <div class="layui-inline" style="margin-left: 20px;margin-top: 10px;">

                            <div class="layui-input-inline">
                                <input type="number" id="grossmininput" autocomplete="off" class="layui-input self-input">
                            </div>
                            <div class="layui-form-mid" style="left: -90px;">~</div>
                            <div class="layui-input-inline" style="left:-75px; ">
                                <input type="number" id="grossmaxinput" autocomplete="off" class="layui-input self-input">
                            </div>
                            <label class="layui-form-label" style="margin-top: -30px;left: -20px;color: #5E5E5E">%</label>
                        </div>

                    </div>

                    <br/>

                    <!-- 提示 -->
                    <p class="number-tip">只可以输入0-100的数字</p>

                    <br/>

                    <!-- 单选框 -->
                    <div style="margin-left: -100px;margin-top: 35px;">
                        <input type="radio" name="grossradio" id="grossradio0">
                        <label class="radio-text">由高到低</label>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <input type="radio" name="grossradio" id="grossradio1">
                        <label class="radio-text">由低到高</label>
                    </div>


                    <div style="margin-right: -90px;margin-top: 5px;">
                        <button class="tip-button" id="grosscancel"><div class="tip-button-cancel">取消</div></button>
                        <button class="tip-button" id="grossreset"><div class="tip-button-reset">重置</div></button>
                        <button class="tip-button" id="grossconfirm"><div class="tip-button-confirm">确认</div></button>
                    </div>
                </div>
            </div>

            <div class="sameline">
                <button class="layui-btn layui-btn-primary conditionbutton" id="retracement"><p class="conditiontext">最大回撤</p></button>
                <div class="tipboard" id="retracement-tip">
                    <!-- 范围 -->
                    <div class="layui-form-item" style="width: 500px;">
                        <div class="layui-inline" style="margin-left: 20px;margin-top: 10px;">

                            <div class="layui-input-inline">
                                <input type="number" id="retracementmininput" autocomplete="off" class="layui-input self-input">
                            </div>
                            <div class="layui-form-mid" style="left: -90px;">~</div>
                            <div class="layui-input-inline" style="left:-75px; ">
                                <input type="number" id="retracementmaxinput" autocomplete="off" class="layui-input self-input">
                            </div>
                            <label class="layui-form-label" style="margin-top: -30px;left: -20px;color: #5E5E5E">%</label>
                        </div>

                    </div>

                    <br/>

                    <!-- 提示 -->
                    <p class="number-tip">只可以输入0-100的数字</p>

                    <br/>

                    <!-- 单选框 -->
                    <div style="margin-left: -100px;margin-top: 35px;">
                        <input type="radio" name="retraceradio" id="retracementradio0">
                        <label class="radio-text">由高到低</label>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <input type="radio" name="retraceradio" id="retracementradio1">
                        <label class="radio-text">由低到高</label>
                    </div>


                    <div style="margin-right: -90px;margin-top: 5px;">
                        <button class="tip-button" id="retracementcancel"><div class="tip-button-cancel">取消</div></button>
                        <button class="tip-button" id="retracementreset"><div class="tip-button-reset">重置</div></button>
                        <button class="tip-button" id="retracementconfirm"><div class="tip-button-confirm">确认</div></button>
                    </div>
                </div>
            </div>

            <div class="sameline">
                <button class="layui-btn layui-btn-primary conditionbutton" id="carry"><p class="conditiontext">市场最大承载资金</p></button>
                <div class="tipboard" id="carry-tip">
                    <!-- 范围 -->
                    <div class="layui-form-item" style="width: 500px;">
                        <div class="layui-inline" style="margin-left: 20px;margin-top: 10px;">

                            <div class="layui-input-inline">
                                <input type="number" id="carrymininput" autocomplete="off" class="layui-input self-input">
                            </div>
                            <div class="layui-form-mid" style="left: -90px;">~</div>
                            <div class="layui-input-inline" style="left:-75px; ">
                                <input type="number" id="carrymaxinput" autocomplete="off" class="layui-input self-input">
                            </div>
                            <label class="layui-form-label" style="margin-top: -30px;left: 10px;color: #5E5E5E">元/分钟</label>
                        </div>

                    </div>

                    <br/>

                    <!-- 提示 -->
                    <p class="number-tip">只可以输入0-100的数字</p>

                    <br/>

                    <!-- 单选框 -->
                    <div style="margin-left: -100px;margin-top: 35px;">
                        <input type="radio" name="carryradio" id="carryradio0">
                        <label class="radio-text">由高到低</label>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <input type="radio" name="carryradio" id="carryradio1">
                        <label class="radio-text">由低到高</label>
                    </div>


                    <div style="margin-right: -90px;margin-top: 5px;">
                        <button class="tip-button" id="carrycancel"><div class="tip-button-cancel">取消</div></button>
                        <button class="tip-button" id="carryreset"><div class="tip-button-reset">重置</div></button>
                        <button class="tip-button" id="carryconfirm"><div class="tip-button-confirm">确认</div></button>
                    </div>
                </div>
            </div>

            <div class="sameline">
                <button class="layui-btn layui-btn-primary conditionbutton" id="win"><p class="conditiontext">胜率</p></button>
                <div class="tipboard" id="win-tip" style="right: 278px;">
                    <!-- 范围 -->
                    <div class="layui-form-item" style="width: 500px;">
                        <div class="layui-inline" style="margin-left: 20px;margin-top: 10px;">

                            <div class="layui-input-inline">
                                <input type="number" id="winmininput" autocomplete="off" class="layui-input self-input">
                            </div>
                            <div class="layui-form-mid" style="left: -90px;">~</div>
                            <div class="layui-input-inline" style="left:-75px; ">
                                <input type="number" id="winmaxinput" autocomplete="off" class="layui-input self-input">
                            </div>
                            <label class="layui-form-label" style="margin-top: -30px;left: -20px;color: #5E5E5E">%</label>
                        </div>

                    </div>

                    <br/>

                    <!-- 提示 -->
                    <p class="number-tip">只可以输入0-100的数字</p>

                    <br/>

                    <!-- 单选框 -->
                    <div style="margin-left: -100px;margin-top: 35px;">
                        <input type="radio" name="winradio" id="winradio0">
                        <label class="radio-text">由高到低</label>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <input type="radio" name="winradio" id="winradio1">
                        <label class="radio-text">由低到高</label>
                    </div>


                    <div style="margin-right: -90px;margin-top: 5px;">
                        <button class="tip-button" id="wincancel"><div class="tip-button-cancel">取消</div></button>
                        <button class="tip-button" id="winreset"><div class="tip-button-reset">重置</div></button>
                        <button class="tip-button" id="winconfirm"><div class="tip-button-confirm">确认</div></button>
                    </div>
                </div>
            </div>

            <div class="sameline" style="">
                <button class="layui-btn layui-btn-primary conditionbutton" id="profit"><p class="conditiontext">盈亏比</p></button>
                <div class="tipboard" id="profit-tip" style="right: 110px;">
                    <!-- 范围 -->
                    <div class="layui-form-item" style="width: 450px;">
                        <div class="layui-inline" style="margin-left: 20px;margin-top: 10px;">

                            <div class="layui-input-inline">
                                <input type="number" id="profitmininput" autocomplete="off" class="layui-input self-input">
                            </div>
                            <div class="layui-form-mid" style="left: -90px;">~</div>
                            <div class="layui-input-inline" style="left:-75px; ">
                                <input type="number" id="profitmaxinput" autocomplete="off" class="layui-input self-input">
                            </div>
                            <label class="layui-form-label" style="margin-top: -30px;left: -20px;color: #5E5E5E">%</label>
                        </div>

                    </div>

                    <br/>

                    <!-- 提示 -->
                    <p class="number-tip">只可以输入0-100的数字</p>

                    <br/>

                    <!-- 单选框 -->
                    <div style="margin-left: -100px;margin-top: 35px;">
                        <input type="radio" name="profitradio" id="profitradio0">
                        <label class="radio-text">由高到低</label>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <input type="radio" name="profitradio" id="profitradio1">
                        <label class="radio-text">由低到高</label>
                    </div>


                    <div style="margin-right: -90px;margin-top: 5px;">
                        <button class="tip-button" id="profitcancel"><div class="tip-button-cancel">取消</div></button>
                        <button class="tip-button" id="profitreset"><div class="tip-button-reset">重置</div></button>
                        <button class="tip-button" id="profitconfirm"><div class="tip-button-confirm">确认</div></button>
                    </div>
                </div>
            </div>
        </div>


        <hr style="margin-top: 60px;margin-bottom: 25px;">

        <div class="futures" id="futures">
            <!-- 期货列表 -->
            <div class="futureboard" id="futureboard0">

                <div class="future_name" id = 'futurename0' onclick="details(0)"></div>
                <div><img class="staricon" src="../imgs/star.png" />
                    <button class="collectbutton" id = "collect0">收藏</button>
                </div>

                <!-- lengend -->
                <div class="legend">
                    <div class="lengend_blue"></div>
                    <div class="lengend_blue_text">回测利率</div>
                </div>

                <div class="graphdiv" id="graphdiv0">
                </div>

                <div class="info">
                    <div class="profit">年化收益率</div>
                    <div class="profittext" id="profittext0"></div>

                    <div class="divisioner1"></div>

                    <div class="retracement">最大回撤</div>
                    <div class="retracementtext" id="retracementtext0"></div>

                    <div class="divisioner2"></div>

                    <div class="carry">市场最大承载资金</div>
                    <div class="carrytext" id="carrytext0"></div>

                    <div class="win">胜率：</div>
                    <div class="wintext" id="wintext0"></div>

                    <div class="loss">盈亏比：</div>
                    <div class="losstext" id="losstext0"></div>

                </div>

                <button class="buybutton" id="buy0" onclick="buy(0)">购买</button>

            </div>

            <div class="futureboard" id="futureboard1">


                <div class="future_name" id = 'futurename1' onclick="details(1)"></div>
                <div><img class="staricon" src="../imgs/star.png" />
                    <button class="collectbutton" id = "collect1">收藏</button>
                </div>

                <!-- lengend -->
                <div class="legend">
                    <div class="lengend_blue"></div>
                    <div class="lengend_blue_text">回测利率</div>
                </div>

                <div class="graphdiv" id="graphdiv1">
                </div>

                <div class="info">
                    <div class="profit">年化收益率</div>
                    <div class="profittext" id="profittext1"></div>

                    <div class="divisioner1"></div>

                    <div class="retracement">最大回撤</div>
                    <div class="retracementtext" id="retracementtext1"></div>

                    <div class="divisioner2"></div>

                    <div class="carry">市场最大承载资金</div>
                    <div class="carrytext" id="carrytext1"></div>

                    <div class="win">胜率：</div>
                    <div class="wintext" id="wintext1"></div>

                    <div class="loss">盈亏比：</div>
                    <div class="losstext" id="losstext1"></div>

                </div>

                <button class="buybutton" id="buy1" onclick="buy(1)">购买</button>

            </div>

            <div class="futureboard" id="futureboard2">

                <div class="future_name" id = 'futurename2' onclick="details(2)"></div>
                <div><img class="staricon" src="../imgs/star.png" />
                    <button class="collectbutton" id = "collect2">收藏</button>
                </div>

                <!-- lengend -->
                <div class="legend">
                    <div class="lengend_blue"></div>
                    <div class="lengend_blue_text">回测利率</div>
                </div>

                <div class="graphdiv" id="graphdiv2">
                </div>

                <div class="info">
                    <div class="profit">年化收益率</div>
                    <div class="profittext" id="profittext2"></div>

                    <div class="divisioner1"></div>

                    <div class="retracement">最大回撤</div>
                    <div class="retracementtext" id="retracementtext2"></div>

                    <div class="divisioner2"></div>

                    <div class="carry">市场最大承载资金</div>
                    <div class="carrytext" id="carrytext2"></div>

                    <div class="win">胜率：</div>
                    <div class="wintext" id="wintext2"></div>

                    <div class="loss">盈亏比：</div>
                    <div class="losstext" id="losstext2"></div>

                </div>

                <button class="buybutton" id="buy2" onclick="buy(2)">购买</button>

            </div>

            <div class="futureboard" id="futureboard3">

                <div class="future_name" id = 'futurename3' onclick="details(3)"></div>
                <div><img class="staricon" src="../imgs/star.png" />
                    <button class="collectbutton" id = "collect3">收藏</button>
                </div>

                <!-- lengend -->
                <div class="legend">
                    <div class="lengend_blue"></div>
                    <div class="lengend_blue_text">回测利率</div>
                </div>

                <div class="graphdiv" id="graphdiv3">
                </div>

                <div class="info">
                    <div class="profit">年化收益率</div>
                    <div class="profittext" id="profittext3"></div>

                    <div class="divisioner1"></div>

                    <div class="retracement">最大回撤</div>
                    <div class="retracementtext" id="retracementtext3"></div>

                    <div class="divisioner2"></div>

                    <div class="carry">市场最大承载资金</div>
                    <div class="carrytext" id="carrytext3"></div>

                    <div class="win">胜率：</div>
                    <div class="wintext" id="wintext3"></div>

                    <div class="loss">盈亏比：</div>
                    <div class="losstext" id="losstext3"></div>

                </div>

                <button class="buybutton" id="buy3" onclick="buy(3)">购买</button>

            </div>

            <div class="futureboard" id="futureboard4">

                <div class="future_name" id = 'futurename4' onclick="details(4)"></div>
                <div><img class="staricon" src="../imgs/star.png" />
                    <button class="collectbutton" id = "collect4">收藏</button>
                </div>

                <!-- lengend -->
                <div class="legend">
                    <div class="lengend_blue"></div>
                    <div class="lengend_blue_text">回测利率</div>
                </div>

                <div class="graphdiv" id="graphdiv4">
                </div>

                <div class="info">
                    <div class="profit">年化收益率</div>
                    <div class="profittext" id="profittext4"></div>

                    <div class="divisioner1"></div>

                    <div class="retracement">最大回撤</div>
                    <div class="retracementtext" id="retracementtext4"></div>

                    <div class="divisioner2"></div>

                    <div class="carry">市场最大承载资金</div>
                    <div class="carrytext" id="carrytext4"></div>

                    <div class="win">胜率：</div>
                    <div class="wintext" id="wintext4"></div>

                    <div class="loss">盈亏比：</div>
                    <div class="losstext" id="losstext4"></div>

                </div>

                <button class="buybutton" id="buy4" onclick="buy(4)">购买</button>

            </div>

            <div class="futureboard" id="futureboard5">

                <div class="future_name" id = 'futurename5' onclick="details(5)"></div>
                <div><img class="staricon" src="../imgs/star.png" />
                    <button class="collectbutton" id = "collect5">收藏</button>
                </div>

                <!-- lengend -->
                <div class="legend">
                    <div class="lengend_blue"></div>
                    <div class="lengend_blue_text">回测利率</div>
                </div>

                <div class="graphdiv" id="graphdiv5">
                </div>

                <div class="info">
                    <div class="profit">年化收益率</div>
                    <div class="profittext" id="profittext5"></div>

                    <div class="divisioner1"></div>

                    <div class="retracement">最大回撤</div>
                    <div class="retracementtext" id="retracementtext5"></div>

                    <div class="divisioner2"></div>

                    <div class="carry">市场最大承载资金</div>
                    <div class="carrytext" id="carrytext5"></div>

                    <div class="win">胜率：</div>
                    <div class="wintext" id="wintext5"></div>

                    <div class="loss">盈亏比：</div>
                    <div class="losstext" id="losstext5"></div>

                </div>

                <button class="buybutton" id="buy5" onclick="buy(5)">购买</button>

            </div>

            <div class="futureboard" id="futureboard6">

                <div class="future_name" id = 'futurename6' onclick="details(6)"></div>
                <div><img class="staricon" src="../imgs/star.png" />
                    <button class="collectbutton" id = "collect6">收藏</button>
                </div>

                <!-- lengend -->
                <div class="legend">
                    <div class="lengend_blue"></div>
                    <div class="lengend_blue_text">回测利率</div>
                </div>

                <div class="graphdiv" id="graphdiv6">
                </div>

                <div class="info">
                    <div class="profit">年化收益率</div>
                    <div class="profittext" id="profittext6"></div>

                    <div class="divisioner1"></div>

                    <div class="retracement">最大回撤</div>
                    <div class="retracementtext" id="retracementtext6"></div>

                    <div class="divisioner2"></div>

                    <div class="carry">市场最大承载资金</div>
                    <div class="carrytext" id="carrytext6"></div>

                    <div class="win">胜率：</div>
                    <div class="wintext" id="wintext6"></div>

                    <div class="loss">盈亏比：</div>
                    <div class="losstext" id="losstext6"></div>

                </div>

                <button class="buybutton" id="buy6" onclick="buy(6)">购买</button>

            </div>

            <div class="futureboard" id="futureboard7">

                <div class="future_name" id = 'futurename7' onclick="details(7)"></div>
                <div><img class="staricon" src="../imgs/star.png" />
                    <button class="collectbutton" id = "collect7">收藏</button>
                </div>

                <!-- lengend -->
                <div class="legend">
                    <div class="lengend_blue"></div>
                    <div class="lengend_blue_text">回测利率</div>
                </div>

                <div class="graphdiv" id="graphdiv7">
                </div>

                <div class="info">
                    <div class="profit">年化收益率</div>
                    <div class="profittext" id="profittext7"></div>

                    <div class="divisioner1"></div>

                    <div class="retracement">最大回撤</div>
                    <div class="retracementtext" id="retracementtext7"></div>

                    <div class="divisioner2"></div>

                    <div class="carry">市场最大承载资金</div>
                    <div class="carrytext" id="carrytext7"></div>

                    <div class="win">胜率：</div>
                    <div class="wintext" id="wintext7"></div>

                    <div class="loss">盈亏比：</div>
                    <div class="losstext" id="losstext7"></div>

                </div>

                <button class="buybutton" id="buy7" onclick="buy(7)">购买</button>

            </div>

        </div>


    </div>
    <div id="paging" class="paging"></div>

</div>


<div class="footer myfooter" ></div>

<div class="buyboard" id="buyBoard">
    <div class="buytitle" id="buytitle">购买</div>
    <br/>
    <div class="moneytext">买入金额</div>
    <div class="risktext">风险等级</div>
    <input type="number" id="moneyinput" autocomplete="off" class="layui-input moneyinput" placeholder="最低金额1000元">
    <input type="number" id="riskinput" autocomplete="off" class="layui-input riskinput" placeholder="1">


    <div class="account">
        &nbsp;
        <input type="radio" name="accountradio" id="save">
        <label class="save-text">储蓄账户（余额：200000￥）</label>
        <br/>
        <input type="radio" name="accountradio" id="credit">
        <label class="credit-text">银行卡账户（余额：3000￥）</label>

    </div>


    <button class="confirmbuybutton" id="confirmbuybutton" onclick="finallyClicked()">确认购买</button>

    <div class="closebutton" onclick="buyboardClosed()">x</div>
    <div id="finally"></div>
</div>

</body>


<script src="../components/top-nav.js"></script>

<script>


    $(".layui-layer-btn0").css("background-color",'rgba(245, 93, 84, 1)');
    function details(id){
        var tradeId = contractList[id].tradeId;
        var contractName = contractList[id].contractName;
        location.href='../details/details.html?tradeId='+tradeId+'&contractName='+contractName;
    }

    var contractList;

    var totalCount = 0;
    var PAGENUM = 8;

    var contractFilterInfo = {
        "contractTradeSearch":{
            "yieldL":0,
            "maxDrawdownL":0,
            "winRateL":0,
            "profitLossRatioL":0,
            "marketCapitalCapacityL":0,
            "yieldR":100,
            "maxDrawdownR":100,
            "winRateR":100,
            "profitRossRatioR":100,
            "marketCapitalCapacityR":100000,
            "type":0
        },
        "userId":1,
        "page":0,
        "pageNum":PAGENUM
    };


    function getContractList(){
        for(var i=0;i<8;i++){
            $("#futureboard"+i).css("visibility","hidden");
        }

        $.ajax({
            url:"http://localhost:8080/api/contract/getList",
            type:"POST",
            //data:contractFilterInfo,
            data:{
                "contractTradeSearch": JSON.stringify(contractFilterInfo.contractTradeSearch),
                "userId":contractFilterInfo.userId,
                "page":contractFilterInfo.page,
                "pageNum":PAGENUM
            },
            dataType: "JSON",
            success: function (data){

                if(data.length == 0){
                    totalCount = PAGENUM * contractFilterInfo.page;
                    alert("没有更多数据！");
                    return ;
                }
                for(var i=0;i<data.length;i++){
                    $("#futureboard"+i).css("visibility","visible");
                }
                contractList = data;
                if(contractList.length == PAGENUM){
                    totalCount = PAGENUM * (contractFilterInfo.page+2);
                }else{
                    totalCount = PAGENUM * (contractFilterInfo.page+1);
                }

                draw();


            },
            error: function (data){
                alert("Please try again latar,");
            }
        });
    }



    function format(list){
        var res = [];
        for(var i=0;i<list.length;i++){
           // res.push(list[i].format('YYYY-MM-DD HH:mm:ss'));
            res.push(list[i].substring(0,19));
        }
        return res;
    }


    function draw(){

        for(var i = 0; i < contractList.length ; i++){
            var info = contractList[i];

            $("#futurename"+i).html(info.contractName);
            $("#profittext"+i).html(parseFloat((info.yearYield*100).toFixed(2))+"%");
            $("#retracementtext"+i).html(parseFloat((info.maxDrawdown*100).toFixed(2))+"%");
            $("#carrytext"+i).html("￥"+parseInt(info.marketCapitalCapacity));
            $("#wintext"+i).html(parseFloat((info.winRate*100).toFixed(2))+"%");
            $("#losstext"+i).html(parseFloat((info.profitLossRatio*100).toFixed(2))+"%");

            var option = {
                grid: {
                    left: "3%",
                    right: "4%",
                    bottom: "3%",
                    top: "4%",
                    containLabel: true
                },
                dataZoom: [
                    {
                        show: true,
                        realtime: true,
                        start: 0,
                        end: 100,
                        height: 30,
                        y: 215
                    },
                    {
                        type: "inside",
                        realtime: true,
                        start: 0,
                        end: 100
                    }
                ],
                xAxis: {
                    type: "category",
                    boundaryGap: false,
                    data: format(info.formatDates)
                },
                yAxis: {
                    type: "value",
                    axisLabel:{
                        formatter: function (value, index){
                            return (value*100).toFixed(0)+'%';
                        }
                    }
                },
                series: [
                    {
                        name: "回测利率",
                        data: info.yields,
                        type: "line",
                        sampling: "average",
                        areaStyle: {
                            normal: {
                                color: "#DAE4F4"
                            }
                        },
                        lineStyle: {
                            normal: {
                                width: 1,
                                color: "#4577C8"
                            }
                        },
                    },
                ]
            };

            var myChart = echarts.init(document.getElementById("graphdiv"+i));
            myChart.setOption(option);
        }
    }

    layui.use(['laypage', 'layer'], function(){
        var laypage = layui.laypage
            ,layer = layui.layer;

        //总页数大于页码总数
        laypage.render({
            elem: 'paging'
            ,count: totalCount //数据总数
            ,limit: PAGENUM
            ,layout:['prev', 'next']
            ,jump: function(obj,first){
                contractFilterInfo.page = obj.curr-1;
                getContractList();
                obj.count = totalCount;

                draw();

            }
            ,theme: '#FD6857'
        });

    });





</script>




<script>

    var currentContract;

    function buy(id){
       currentContract = contractList[id];
        $("#buytitle").html("购买"+currentContract.contractName);
        $("#contentdiv").css("opacity","0.4");
        $("#buyBoard").css("visibility","visible");

    }

    function buyboardClosed(){
        $("#contentdiv").css("opacity","1");
        $("#buyBoard").css("visibility","hidden");
    }

    function finallyClicked(){

        layui.use('layer', function(){ //独立版的layer无需执行这一句
            var layer = layui.layer; //独立版的layer无需执行这一句

            layer.open({
                type: 1
                ,title: ' '
                ,content: '<div class="tipbeforebuy">购买的金额超过了当前市场最大承载资金，<br/>请问是否继续?</div>'+
                    "<div style='text-align: center;padding-bottom: 30px'>" +
                "<button style='width: 60px;height: 32px;border-radius: 2px;border:1px solid #ff5a5f;color: white;background-color: #ff5a5f'>继续</button>" +
                "<button style='width: 60px;height: 32px;border-radius: 2px;margin-left: 6px;color:#5e5e5e;border: 1px solid #cdcdcd'>取消</button></div>"
//                ,btn: ['继续', '取消']
                ,btnAlign: 'c' //按钮居中
                ,shade: 0 //不显示遮罩
                ,yes: function(){
                    layer.closeAll();
                    buyboardClosed();
                }

                ,btn2: function(){
                }
            });
        });
    }


    $("#profittext0").innerHTML = "hihi";


    function ftclicked(id){
        closeftbottom();
        var type = 0;

        if(id=='financial'){
            type = 1;
        }else if(id=='agriculture'){
            type = 2;
        }else if(id=='metal'){
            type = 3;
        }else if(id=='energy'){
            type = 4;
        }else if(id=='chemical'){
            type = 5;
        }

        contractFilterInfo.contractTradeSearch.type = type;
        var name = id+"_bottom";
        $("#"+id).css("color","#FD6857");
        $("#"+name).css("visibility","visible");

        getContractList();
        draw();
    }

    function closeftbottom(){
        $("#all_bottom").css("visibility","hidden");
        $("#financial_bottom").css("visibility","hidden");
        $("#agriculture_bottom").css("visibility","hidden");
        $("#metal_bottom").css("visibility","hidden");
        $("#energy_bottom").css("visibility","hidden");
        $("#chemical_bottom").css("visibility","hidden");

        $("#all").css("color","rgba(94, 94, 94, 1)");
        $("#financial").css("color","rgba(94, 94, 94, 1)");
        $("#agriculture").css("color","rgba(94, 94, 94, 1)");
        $("#metal").css("color","rgba(94, 94, 94, 1)");
        $("#energy").css("color","rgba(94, 94, 94, 1)");
        $("#chemical").css("color","rgba(94, 94, 94, 1)");
    }



    var mobilitymin = 0;
    var mobilitymax = 100;
    var mobilityradio = 0;
    var grossmin = 0;
    var grossmax = 100;
    var grossradio = 0;
    var retracementmin = 0;
    var retracementmax = 100;
    var retraceradio = 0;
    var carrymin = 0;
    var carrymax = 100;
    var carryradio = 0;
    var winmin =0;
    var winmax = 100;
    var winradio = 0;
    var profitmin = 0;
    var profitmax = 100;
    var profitradio = 0;

    $("button").css("outline","none");

    layui.use('element', function(){
        var element = layui.element; //导航的hover效果、二级菜单等功能，需要依赖element模块

        //监听导航点击
        element.on('nav(demo)', function(elem){
            //console.log(elem)
            layer.msg(elem.text());
        });
    });


    function closetip(){
        $("#mobility-tip").css("visibility","hidden");
        $("#gross-tip").css("visibility","hidden");
        $("#retracement-tip").css("visibility","hidden");
        $("#carry-tip").css("visibility","hidden");
        $("#win-tip").css("visibility","hidden");
        $("#profit-tip").css("visibility","hidden");

    }

    // mobility的弹框
    $("#mobility").click(function() {
        closetip();
        $("#mobility-tip").css("visibility","visible");
        $("#mobilitymininput").val(mobilitymin);
        $("#mobilitymaxinput").val(mobilitymax);

        if(mobilityradio==0){
            document.getElementById("mobilityradio1").checked=false;
            document.getElementById("mobilityradio0").checked=true;
        }else{
            document.getElementById("mobilityradio0").checked=false;
            document.getElementById("mobilityradio1").checked=true;
        }
    });

    $("#mobilitycancel").click(function () {
        $("#mobility-tip").css("visibility","hidden");
    });

    $("#mobilityreset").click(function (){
        mobilitymin = 0;
        mobilitymax = 100;
        mobilityradio = 0;

        $("#mobilitymininput").val(mobilitymin);
        $("#mobilitymaxinput").val(mobilitymax);
        document.getElementById("mobilityradio1").checked=false;
        document.getElementById("mobilityradio0").checked=true;

        $("#mobility").css("background-color","white");
        $("#mobility").css("color","black");
    });

    $("#mobilityconfirm").click(function (){
        mobilitymin = $("#mobilitymininput").val();
        mobilitymax = $("#mobilitymaxinput").val();

        if(document.getElementById("mobilityradio0").checked){
            mobilityradio = 0;
        }else{
            mobilityradio = 1;
        }

        $("#mobility-tip").css("visibility","hidden");

        $("#mobility").css("background-color","rgba(253, 104, 87, 1)");
        $("#mobility").css("color","rgba(255, 255, 255, 1)");
    });



    // gross的弹框
    $("#gross").click(function() {
        closetip();
        $("#gross-tip").css("visibility","visible");
        $("#grossmininput").val(grossmin);
        $("#grossmaxinput").val(grossmax);

        if(grossradio==0){
            document.getElementById("grossradio1").checked=false;
            document.getElementById("grossradio0").checked=true;
        }else{
            document.getElementById("grossradio0").checked=false;
            document.getElementById("grossradio1").checked=true;
        }
    });

    $("#grosscancel").click(function () {
        $("#gross-tip").css("visibility","hidden");
    });

    $("#grossreset").click(function (){
        grossmin = 0;
        grossmax = 100;
        grossradio = 0;

        $("#grossmininput").val(grossmin);
        $("#grossmaxinput").val(grossmax);
        document.getElementById("grossradio1").checked=false;
        document.getElementById("grossradio0").checked=true;

        $("#gross").css("background-color","white");
        $("#gross").css("color","black");
    });

    $("#grossconfirm").click(function (){
        grossmin = $("#grossmininput").val();
        grossmax = $("#grossmaxinput").val();

        if(document.getElementById("grossradio0").checked){
            grossradio = 0;
        }else{
            grossradio = 1;
        }

        $("#gross-tip").css("visibility","hidden");

        $("#gross").css("background-color","rgba(253, 104, 87, 1)");
        $("#gross").css("color","rgba(255, 255, 255, 1)");
    });





    // retracement的弹框
    $("#retracement").click(function() {
        closetip();
        $("#retracement-tip").css("visibility","visible");
        $("#retracementmininput").val(retracementmin);
        $("#retracementmaxinput").val(retracementmax);

        if(retraceradio==0){
            document.getElementById("retracementradio1").checked=false;
            document.getElementById("retracementradio0").checked=true;
        }else{
            document.getElementById("retracementradio0").checked=false;
            document.getElementById("retracementradio1").checked=true;
        }
    });

    $("#retracementcancel").click(function () {
        $("#retracement-tip").css("visibility","hidden");
    });

    $("#retracementreset").click(function (){
        retracementmin = 0;
        retracementmax = 100;
        retraceradio = 0;

        $("#retracementmininput").val(retracementmin);
        $("#retracementmaxinput").val(retracementmax);
        document.getElementById("retracementradio1").checked=false;
        document.getElementById("retracementradio0").checked=true;

        $("#retracement").css("background-color","white");
        $("#retracement").css("color","black");
    });

    $("#retracementconfirm").click(function (){
        retracementmin = $("#retracementmininput").val();
        retracementmax = $("#retracementmaxinput").val();

        if(document.getElementById("retracementradio0").checked){
            retraceradio = 0;
        }else{
            retraceradio = 1;
        }

        $("#retracement-tip").css("visibility","hidden");

        $("#retracement").css("background-color","rgba(253, 104, 87, 1)");
        $("#retracement").css("color","rgba(255, 255, 255, 1)");
    });


    // carry
    $("#carry").click(function() {
        closetip();
        $("#carry-tip").css("visibility","visible");
        $("#carrymininput").val(carrymin);
        $("#carrymaxinput").val(carrymax);

        if(carryradio==0){
            document.getElementById("carryradio1").checked=false;
            document.getElementById("carryradio0").checked=true;
        }else{
            document.getElementById("carryradio0").checked=false;
            document.getElementById("carryradio1").checked=true;
        }
    });

    $("#carrycancel").click(function () {
        $("#carry-tip").css("visibility","hidden");
    });

    $("#carryreset").click(function (){
        carrymin = 0;
        carrymax = 100;
        carryradio = 0;

        $("#carrymininput").val(carrymin);
        $("#carrymaxinput").val(carrymax);
        document.getElementById("carryradio1").checked=false;
        document.getElementById("carryradio0").checked=true;

        $("#carry").css("background-color","white");
        $("#carry").css("color","black");
    });

    $("#carryconfirm").click(function (){
        carrymin = $("#carrymininput").val();
        carrymax = $("#carrymaxinput").val();

        if(document.getElementById("carryradio0").checked){
            carryradio = 0;
        }else{
            carryradio = 1;
        }

        $("#carry-tip").css("visibility","hidden");

        $("#carry").css("background-color","rgba(253, 104, 87, 1)");
        $("#carry").css("color","rgba(255, 255, 255, 1)");
    });


    // win的弹框
    $("#win").click(function() {
        closetip();
        $("#win-tip").css("visibility","visible");
        $("#winmininput").val(winmin);
        $("#winmaxinput").val(winmax);

        if(winradio==0){
            document.getElementById("winradio1").checked=false;
            document.getElementById("winradio0").checked=true;
        }else{
            document.getElementById("winradio0").checked=false;
            document.getElementById("winradio1").checked=true;
        }
    });

    $("#wincancel").click(function () {
        $("#win-tip").css("visibility","hidden");
    });

    $("#winreset").click(function (){
        winmin = 0;
        winmax = 100;
        winradio = 0;

        $("#winmininput").val(winmin);
        $("#winmaxinput").val(winmax);
        document.getElementById("winradio1").checked=false;
        document.getElementById("winradio0").checked=true;

        $("#win").css("background-color","white");
        $("#win").css("color","black");
    });

    $("#winconfirm").click(function (){
        winmin = $("#winmininput").val();
        winmax = $("#winmaxinput").val();

        if(document.getElementById("winradio0").checked){
            winradio = 0;
        }else{
            winradio = 1;
        }

        $("#win-tip").css("visibility","hidden");

        $("#win").css("background-color","rgba(253, 104, 87, 1)");
        $("#win").css("color","rgba(255, 255, 255, 1)");
    });


    // profit的弹框
    $("#profit").click(function() {
        closetip();
        $("#profit-tip").css("visibility","visible");
        $("#profitmininput").val(profitmin);
        $("#profitmaxinput").val(profitmax);

        if(profitradio==0){
            document.getElementById("profitradio1").checked=false;
            document.getElementById("profitradio0").checked=true;
        }else{
            document.getElementById("profitradio0").checked=false;
            document.getElementById("profitradio1").checked=true;
        }
    });

    $("#profitcancel").click(function () {
        $("#profit-tip").css("visibility","hidden");
    });

    $("#profitreset").click(function (){
        profitmin = 0;
        profitmax = 100;
        profitradio = 0;

        $("#profitmininput").val(profitmin);
        $("#profitmaxinput").val(profitmax);
        document.getElementById("profitradio1").checked=false;
        document.getElementById("profitradio0").checked=true;

        $("#profit").css("background-color","white");
        $("#profit").css("color","black");
    });

    $("#profitconfirm").click(function (){
        profitmin = $("#profitmininput").val();
        profitmax = $("#profitmaxinput").val();

        if(document.getElementById("profitradio0").checked){
            profitradio = 0;
        }else{
            profitradio = 1;
        }

        $("#profit-tip").css("visibility","hidden");

        $("#profit").css("background-color","rgba(253, 104, 87, 1)");
        $("#profit").css("color","rgba(255, 255, 255, 1)");
    });



</script>


</html>


























